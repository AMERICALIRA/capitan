<div class="container-md pv-56 puntos border-bottom-gray">
  <h4 class="bold mb-7 text-center">puntos</h4>
  <div class="hidden-xs mb-7 separator separator-primary separator-centered"></div>
  <div class="light text-center mt-35 font-big">
    este es el detalle de tu avance hasta ahora en el
      <span class="dropdown header-arrow">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">
            <span class="text-uppercase sprint-name gray-29">
              <%= "Sprint #{@sprint_index}" %>
            </span>
            <%= image_tag "arrow-up.png",alt: "Arrow up", class: "minh-icon-arrow arrow up hide", data: { el: "down" } %>
            <%= image_tag "arrow-down.png",alt: "Arrow down", class: "minh-icon-arrow arrow down", data: { el: "up" } %>
          </a>
          <ul class="dropdown-menu sprint-dropdown">
            <% @sprints.each_with_index do |sprint, index| %>
              <li> <%= link_to "Sprint #{index+1}", '#', class: 'text-uppercase font-big' %> </li>
            <% end %>
          </ul>
      </span>
  </div>
  <div class="row pt-21">
    <div class="col-md-6">
      <div id="container" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto"></div>
    </div>
    <div class="col-md-6 pv-49 ph-35">
      <div class="row pl-70-md">
        <div class="col-sm-12">
          <div class="c100 big orange <%= "p#{percentage(@max_student_points, @max_total_points).round }"%>">
            <span>
              <%= "#{percentage(@max_student_points, @max_total_points).round(1)}%" %>
            </span>
            <div class="slice">
              <div class="bar"></div>
              <div class="fill"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-5 col-sm-offset-3 text-center">
          <p class="score">
            <span class="book gray-29"><%= @max_student_points %></span>
            <span class="slash">/</span>
            <span class="thin h4"><%= @max_total_points %></span>
          </p>
          <h4 class="light">puntos</h4>
        </div>
      </div>
    </div>
  </div>
</div>

<% content_for :scripts do %>
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script>
    $(function () {
      $('#container').highcharts({
        chart: {
          plotBackgroundColor: "#fcfcfc",
          plotBorderWidth: 0,
          plotShadow: false,
          backgroundColor: "#fcfcfc",
        },
        title: {
          text: '<div style="color:#444;font-size:24px"><%= @max_student_points %></div>puntos',
          align: 'center',
          verticalAlign: 'middle',
          useHTML: true,
          y: 10,
          style: {
            color: '#888',
            textAlign: 'center',
            fontSize: '20px',
            fontFamily: "museo-sans"
          }
        },
        credits: {
          enabled: false
       },
        tooltip: {
          pointFormat: '{series.name}: <b>{point.student_marks}</b>/{point.y}',
          fontFamily: "museo-sans"
        },
        plotOptions: {
          pie: {
            dataLabels: {
              enabled: true,
              distance: 25,
              style: {
                color: '#4a4a4a',
                textShadow: 0,
                fontSize: '14px',
                fontFamily: "museo-sans",
                fontWeight: 300
              }
            },
            center: ['50%', '55%']
          }
        },
        series: [{
          type: 'pie',
          name: "Quizzes",
          innerSize: '80%',
          data: <%= raw @data.to_json %>,
          color: '#222',
          animation: {
            duration: 1500,
            easing: 'easeOutBounce'
          }
        }]
      });

      var chart = $('#container').highcharts();
      var colors = ['#66B26D', '#4790C8', '#E2BA39',
                    '#D2813A', '#CD5C48', '#795299',
                    '#AC4937','#E09A37', '#BE5E29'
                  ];
      var i = 0;
      chart.series[0].data.forEach(function(data){
        data.update({color: colors[i]});
        i++;
      });
    });
  </script>
<% end %>
