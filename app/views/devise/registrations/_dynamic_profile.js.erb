var districts = [];
var educations = [];
var semestersLeft = [];
var familyIncome = [];
var spots = [];
var salaries = [];

<% District.all.each do |district| %>
  districts.push([<%= district.branch_id %>,"<%= district.name %>",<%= district.id %>]);
<% end %>

<% Education.all.each do |education| %>
  educations.push([<%= education.branch_id %>,"<%= education.name %>",<%= education.id %>]);
<% end %>

<% SemestersLeft.all.each do |semester| %>
  semestersLeft.push([<%= semester.branch_id %>,"<%= semester.name %>",<%= semester.id %>]);
<% end %>

<% FamilyIncome.all.each do |income| %>
  familyIncome.push([<%= income.branch_id %>,"<%= income.name %>",<%= income.id %>]);
<% end %>

<% Spot.all.each do |spot| %>
  spots.push([<%= spot.branch_id %>,"<%= spot.name %>",<%= spot.id %>]);
<% end %>

<% JobSalary.all.each do |salary| %>
  salaries.push([<%= salary.branch_id %>,"<%= salary.name %>",<%= salary.id %>]);
<% end %>

window.addEventListener('load',function() {
  $('#user_signup_branch').on("change",function() {
    var branchId = parseInt($(this).val());
    changeSelect(branchId,'#user_profile_attributes_district_id','Elige colonia/distrito/comuna',districts);
    changeSelect(branchId,'#user_profile_attributes_education_id','Elige tu grado de educación',educations);
    changeSelect(branchId,'#user_profile_attributes_semesters_left_id','Elige una opción',semestersLeft);
    changeSelect(branchId,'#user_profile_attributes_family_income_id','Elige una opción',familyIncome);
    changeSelect(branchId,'#user_profile_attributes_spot_id','Elige una opción',spots);
    changeSelect(branchId,'#user_profile_attributes_job_salary_id','Elige una opción',salaries);
  });
});

function changeSelect(branchId,selectId,blankText,options) {
  var select = $(selectId);
  select.empty();
  select.append('<option>'+blankText+'</option>');
  options.forEach(function(option) {
    if (option[0] == branchId) {
      select.append('<option value="'+option[2]+'">'+option[1]+'</option>');
    }
  });
}
